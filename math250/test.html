<!DOCTYPE HTML>
<html>
  <head>
    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>MATH 250</title>
    <script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
    });
    </script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>
<body style="width: 1000px;">

  <h1>Math 250</h1>
  
<div class="compute"><script type="text/x-sage">

# everything following hash symbol is comment
import numpy;
t= var('t') #independent variable
x = var('x')  #dependent variable
y = var('y')  #dependent variable
z = var('z')  #dependent variable
w = var('w')  #dependent variable

##euler method for system dy/dx = f(x,y,z) and dz/dx = g(x,y,z) using sage

#change arguments as needed for hws/exercises
m = 0.0046
g = 9.8
rho = 1.204
CD = 0.25
A = pi*(0.04267/2)^2

### function and parameters ###
def fx(t,x,y,z,w): return y
def fy(t,x,y,z,w): return -CD*rho*A*y*sqrt(y^2+w^2)/(m*2.)
def fz(t,x,y,z,w): return w
def fw(t,x,y,z,w): return -g - CD*rho*A*w*sqrt(y^2+w^2)/(m*2.)

h=0.01
t0 = 0  #begin t value
t1 = 5  #end t value
x0 = 1.
y0 = 1.
z0 = 1.
w0 = 1.

########################
N = floor((t1-t0)/h)
RKx = numpy.zeros(shape=(N+1,2))
RKy = numpy.zeros(shape=(N+1,2))
RKz = numpy.zeros(shape=(N+1,2))
RKw = numpy.zeros(shape=(N+1,2))
RKxz = numpy.zeros(shape=(N+1,2))

t = t0
x = x0
y = y0
z = z0
w = w0

RKx[0] = [t0,x0]
RKy[0] = [t0,y0]
RKz[0] = [t0,z0]
RKw[0] = [t0,w0]

RKxz[0] = [x0,z0]

for i in range(N):  #RK method loop
    kx1 = fx(t,x,y,z,w)
    ky1 = fy(t,x,y,z,w)
    kz1 = fz(t,x,y,z,w)
    kw1 = fw(t,x,y,z,w)
    
    kx2 = fx(t+h/2.,x+h*kx1/2,y+h*ky1/2.,z+h*kz1/2.,w+h*kw1/2.)
    ky2 = fy(t+h/2.,x+h*kx1/2,y+h*ky1/2.,z+h*kz1/2.,w+h*kw1/2.)
    kz2 = fz(t+h/2.,x+h*kx1/2,y+h*ky1/2.,z+h*kz1/2.,w+h*kw1/2.)
    kw2 = fw(t+h/2.,x+h*kx1/2,y+h*ky1/2.,z+h*kz1/2.,w+h*kw1/2.)
    
    kx3 = fx(t+h/2.,x+h*kx2/2,y+h*ky2/2.,z+h*kz2/2.,w+h*kw2/2.)
    ky3 = fy(t+h/2.,x+h*kx2/2,y+h*ky2/2.,z+h*kz2/2.,w+h*kw2/2.)
    kz3 = fz(t+h/2.,x+h*kx2/2,y+h*ky2/2.,z+h*kz2/2.,w+h*kw2/2.)
    kw3 = fw(t+h/2.,x+h*kx2/2,y+h*ky2/2.,z+h*kz2/2.,w+h*kw2/2.)
    
    kx4 = fx(t+h,x+h*kx3,y+h*ky3,z+h*kz3,w+h*kw3)
    ky4 = fy(t+h,x+h*kx3,y+h*ky3,z+h*kz3,w+h*kw3)
    kz4 = fz(t+h,x+h*kx3,y+h*ky3,z+h*kz3,w+h*kw3)
    kw4 = fw(t+h,x+h*kx3,y+h*ky3,z+h*kz3,w+h*kw3)

    x = x + h*(kx1+2*kx2+2*kx3+kx4)/6.
    y = y + h*(ky1+2*ky2+2*ky3+ky4)/6.
    z = z + h*(kz1+2*kz2+2*kz3+kz4)/6.
    w = w + h*(kw1+2*kw2+2*kw3+kw4)/6.
    
    t = t + h
    
    RKx[i+1] = [t,x]
    RKy[i+1] = [t,y]
    RKz[i+1] = [t,z]
    RKw[i+1] = [t,w]

    RKxz[i+1] = [x,z]
    
##comment 5 lines below to stop plotting output

Prk1 = list_plot(RKxz) #blue is default color
Prk2 = line(RKxz)

show(Prk1+Prk2,ymin=0)

</div>

</body>
</html>
